syntax="proto3";

import "google/protobuf/empty.proto";

service KeyNode {
    rpc validate (ValidateRequest) returns (TransactionState) {}
    rpc endTransaction (TransactionState) returns (google.protobuf.Empty) {}
}

message KeyRequest {
    string tid = 1;
    string key = 2;
    repeated string readSet = 3;
    string begints = 4;
    string lowerBound = 5;
}

message KeyResponse {
    string tid = 1;
    string keyversion = 2;
    bytes value = 3;
    repeated string coWrittenSet = 4;
}

message ValidateRequest {
    string tid = 1;
    string begints = 2;
    string committs = 3;
    repeated string keys = 4;
    repeated string writeset = 5;
}

message TransactionState {
    string tid = 1;
    TransactionAction s = 2;
    map<string, bytes> writeBuffer = 3;
}

enum TransactionAction {
    COMMIT = 0;
    ABORT = 1;
}
